<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title th:text="${title}">DustNovel</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<!-- THEME CSS -->
	<link rel="stylesheet" th:href="@{/css/theme.css}">
	<style>
		/* ===== THEME TOGGLE SWITCH ===== */
		.theme-switch {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 12px;
			padding: 10px 14px;
		}

		.theme-switch span {
			font-size: 13px;
		}

		.switch {
			position: relative;
			width: 44px;
			height: 24px;
		}

		.switch input {
			opacity: 0;
			width: 0;
			height: 0;
		}

		.slider {
			position: absolute;
			inset: 0;
			background: #ddd;
			border-radius: 999px;
			transition: .3s;
		}

		.slider:before {
			content: "‚òÄÔ∏è";
			position: absolute;
			width: 20px;
			height: 20px;
			left: 2px;
			top: 2px;
			background: white;
			border-radius: 50%;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 12px;
			transition: .3s;
		}

		input:checked+.slider {
			background: #2b2b2b;
		}

		input:checked+.slider:before {
			transform: translateX(20px);
			content: "üåô";
		}

		/* M·∫∑c ƒë·ªãnh (light) */
		.theme-label {
			color: #212529;
		}

		/* Dark mode */
		[data-theme="dark"] .theme-label {
			color: #f1f1f1;
		}

		/* ===== SWITCH CHUNG ===== */
		.theme-switch {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 12px;
		}

		.theme-switch span {
			font-size: 14px;
		}

		/* ===== FONT & SIZE ===== */
		body {
			font-size: 14px;
		}

		.navbar {
			font-size: 14px;
		}

		.navbar-brand span {
			font-size: 16px;
		}

		/* ===== TH·ªÇ LO·∫†I DROPDOWN ===== */
		.theloai-dropdown {
			left: 50% !important;
			transform: translateX(-50%);
			width: 1100px;
			max-width: 90vw;
			max-height: 300px;
			overflow-y: auto;
			column-count: 7;
			padding: 20px;
		}

		.theloai-dropdown .dropdown-item {
			white-space: normal;
			padding: 6px 12px;
			font-size: 13px;
		}

		/* ===== SEARCH ===== */
		.search-input {
			width: 220px;
			font-size: 13px;
		}

		/* ===== USER DROPDOWN ===== */
		.user-dropdown {
			min-width: 260px;
		}

		/* ===== TOKEN BOX (GI·ªêNG STYLE GIAO DI·ªÜN) ===== */
		.token-box {
			display: flex;
			align-items: center;
			justify-content: space-between;
			padding: 10px 14px;
			margin-bottom: 6px;
			border-radius: 8px;
			background: rgba(0, 0, 0, 0.04);
			font-size: 13px;
		}

		.token-label {
			color: #495057;
			display: flex;
			align-items: center;
			gap: 6px;
		}

		.token-value {
			font-weight: 600;
			color: #f4b400;
			/* v√†ng coin */
			letter-spacing: 0.4px;
		}

		/* Dark mode */
		[data-theme="dark"] .token-box {
			background: rgba(255, 255, 255, 0.06);
		}

		[data-theme="dark"] .token-label {
			color: #e5e5e5;
		}

		/* ===== THEME SWITCH (GI·ªÆ NGUY√äN STYLE C≈®) ===== */
		.theme-switch {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 12px;
			padding: 10px 14px;
		}

		.theme-label {
			font-size: 13px;
			color: #212529;
		}

		[data-theme="dark"] .theme-label {
			color: #f1f1f1;
		}
	</style>
</head>

<body data-theme="light">
	<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
		<div class="container"> <a class="navbar-brand fw-bold d-flex align-items-center" th:href="@{/DustNovel/home}">
				<img th:src="@{/images/logo.png}" height="36" class="me-2"> <span>DustNovel</span> </a> <button
				class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"> <span
					class="navbar-toggler-icon"></span> </button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav me-3">
					<li class="nav-item"><a class="nav-link" th:href="@{/DustNovel/themtruyen}">‚ûï Th√™m truy·ªán</a></li>
					<li class="nav-item dropdown position-static"><a class="nav-link dropdown-toggle" href="#"
							data-bs-toggle="dropdown">üìö Th·ªÉ lo·∫°i</a>
						<ul class="dropdown-menu theloai-dropdown">
							<li th:each="tl : ${theLoais}"><a class="dropdown-item"
									th:href="@{/DustNovel/the-loai/{id}(id=${tl.id})}" th:text="${tl.tenTheLoai}"></a>
							</li>
						</ul>
					</li>
					<li class="nav-item"><a class="nav-link" th:href="@{/DustNovel/nap-tien}">üí∞ N·∫°p ti·ªÅn</a></li>
					<li class="nav-item"><a class="nav-link" th:href="@{/DustNovel/truyen/tim-kiem-nang-cao}">üîé T√¨m
							ki·∫øm n√¢ng cao</a></li>
					<li class="nav-item" sec:authorize="hasRole('ADMIN')">
						<a class="nav-link" th:href="@{/dba/user}">
							üìä Dashboard
						</a>
					</li>
					<li class="nav-item" sec:authorize="hasRole('USER')">
						<a class="nav-link" th:href="@{/dbu/}">
							üìä Dashboard
						</a>
					</li>
				</ul>
				<form class="d-flex ms-auto me-3" th:action="@{/DustNovel/truyen/tim-kiem}" method="get"> <input
						class="form-control search-input me-2" type="search" name="keyword" placeholder="T√¨m truy·ªán...">
					<button class="btn btn-outline-primary btn-sm">üîç</button>
				</form>
				<ul class="navbar-nav">
					<div sec:authorize="isAnonymous()"> <a th:href="@{/DustNovel/login}"
							class="ms-1 text-decoration-none">ƒêƒÉng nh·∫≠p</a> </div>
					<div class="dropdown d-flex align-items-center gap-2" sec:authorize="isAuthenticated()"> <span
							class="hello-user"> Xin ch√†o, <span sec:authentication="name"></span> </span> <button
							class="btn btn-secondary rounded-circle fw-bold text-white" type="button"
							data-bs-toggle="dropdown" style="width: 42px; height: 42px"> <span
								th:text="${#strings.toUpperCase(#strings.substring(#authentication.name,0,1))}"></span>
						</button>
						<ul class="dropdown-menu dropdown-menu-end shadow-sm">
							<li><a class="dropdown-item" th:href="@{/DustNovel/user/profile}"> Th√¥ng tin t√†i kho·∫£n </a>
							</li>
							<li class="px-3 py-2">
								<div class="token-box"> <span class="token-label">ü™ô Token</span> <span
										class="token-value" th:text="${userToken}">0</span> </div>
								<div class="theme-switch"> <span class="theme-label">Giao di·ªán</span> <label
										class="switch"> <input type="checkbox" id="themeToggle"> <span
											class="slider"></span> </label> </div>
							</li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li>
								<form th:action="@{/DustNovel/logout}" method="post"> <button type="submit"
										class="dropdown-item text-danger"> ƒêƒÉng xu·∫•t </button> </form>
							</li>
						</ul>
					</div>
				</ul>
			</div>
		</div>
	</nav>
	<div class="container my-4">
		<div th:replace="${content} :: content"></div>
	</div>
	<footer class="text-center py-2 border-top"> <small>¬© 2025 - DustNovel</small> </footer>
	<script> const toggle = document.getElementById("themeToggle"); function applyTheme(theme) {document.body.setAttribute("data-theme", theme); localStorage.setItem("theme", theme); toggle.checked = theme === "dark";} toggle.addEventListener("change", () => {applyTheme(toggle.checked ? "dark" : "light");}); (function () {const saved = localStorage.getItem("theme") || "light"; applyTheme(saved);})(); </script>
</body>

</html>
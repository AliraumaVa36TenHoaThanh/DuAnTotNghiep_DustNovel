<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title th:text="${title}">DustNovel</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- THEME CSS -->
<link rel="stylesheet" th:href="@{/css/theme.css}">

<style>
/* ===== FONT & SIZE ===== */
body { font-size: 14px; }
.navbar { font-size: 14px; }
.navbar-brand span { font-size: 16px; }

/* ===== THá»‚ LOáº I DROPDOWN ===== */
.theloai-dropdown {
	left: 50% !important;
	transform: translateX(-50%);
	width: 1100px;
	max-width: 90vw;
	max-height: 300px;
	overflow-y: auto;
	column-count: 7;
	padding: 20px;
}

.theloai-dropdown .dropdown-item {
	white-space: normal;
	padding: 6px 12px;
	font-size: 13px;
}

/* ===== SEARCH ===== */
.search-input {
	width: 220px;
	font-size: 13px;
}
</style>
</head>

<body data-theme="light">

<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
	<div class="container">

		<a class="navbar-brand fw-bold d-flex align-items-center"
		   th:href="@{/DustNovel/home}">
			<img th:src="@{/images/logo.png}" height="36" class="me-2">
			<span>DustNovel</span>
		</a>

		<button class="navbar-toggler" type="button"
		        data-bs-toggle="collapse" data-bs-target="#navbarNav">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarNav">

			<ul class="navbar-nav me-3">
				<li class="nav-item">
					<a class="nav-link" th:href="@{/DustNovel/themtruyen}">â• ThÃªm truyá»‡n</a>
				</li>

				<li class="nav-item dropdown position-static">
					<a class="nav-link dropdown-toggle" href="#" data-bs-toggle="dropdown">ğŸ“š Thá»ƒ loáº¡i</a>
					<ul class="dropdown-menu theloai-dropdown">
						<li th:each="tl : ${theLoais}">
							<a class="dropdown-item"
							   th:href="@{/DustNovel/the-loai/{id}(id=${tl.id})}"
							   th:text="${tl.tenTheLoai}"></a>
						</li>
					</ul>
				</li>

				<li class="nav-item"><a class="nav-link" th:href="@{/DustNovel/nap-tien}">ğŸ’° Náº¡p tiá»n</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/DustNovel/guild}">ğŸ›¡ï¸ Guild</a></li>
			</ul>

			<form class="d-flex ms-auto me-3"
			      th:action="@{/DustNovel/truyen/tim-kiem}" method="get">
				<input class="form-control search-input me-2"
				       type="search" name="keyword" placeholder="TÃ¬m truyá»‡n...">
				<button class="btn btn-outline-primary btn-sm">ğŸ”</button>
			</form>

			<ul class="navbar-nav">

				<div sec:authorize="isAnonymous()">
					<a th:href="@{/DustNovel/login}" class="ms-1 text-decoration-none">ÄÄƒng nháº­p</a>
				</div>

				<div class="dropdown d-flex align-items-center gap-2"
				     sec:authorize="isAuthenticated()">

					<span class="hello-user">
						Xin chÃ o, <span sec:authentication="name"></span>
					</span>

					<button class="btn btn-secondary rounded-circle fw-bold text-white"
					        type="button" data-bs-toggle="dropdown"
					        style="width:42px;height:42px">
						<span th:text="${#strings.toUpperCase(#strings.substring(#authentication.name,0,1))}"></span>
					</button>

					<ul class="dropdown-menu dropdown-menu-end shadow-sm">
						<li>
							<a class="dropdown-item" th:href="@{/DustNovel/user/profile}">
								ThÃ´ng tin tÃ i khoáº£n
							</a>
						</li>

						<li>
							<span class="dropdown-item theme-toggle" onclick="toggleTheme()">
								ğŸŒ— Giao diá»‡n SÃ¡ng / Tá»‘i
							</span>
						</li>

						<li><hr class="dropdown-divider"></li>

						<li>
							<a class="dropdown-item text-danger"
							   th:href="@{/DustNovel/logout}">
								ÄÄƒng xuáº¥t
							</a>
						</li>
					</ul>
				</div>

			</ul>
		</div>
	</div>
</nav>

<div class="container my-4">
	<div th:replace="${content} :: content"></div>
</div>

<footer class="text-center py-2 border-top">
    <small>Â© 2025 - DustNovel</small>
</footer>

<script>
function toggleTheme() {
	const body = document.body;
	const current = body.getAttribute("data-theme");
	const next = current === "dark" ? "light" : "dark";
	body.setAttribute("data-theme", next);
	localStorage.setItem("theme", next);
}

(function () {
	const saved = localStorage.getItem("theme") || "light";
	document.body.setAttribute("data-theme", saved);
})();
</script>

</body>
</html>
